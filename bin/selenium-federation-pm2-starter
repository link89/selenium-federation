#!/usr/bin/env node

const { spawn } = require('child_process');
const { join, resolve } = require('path');

const yargs = require('yargs/yargs')(process.argv.slice(2));
const argv = yargs.usage('start selenium-federation with pm2').options({
  'name': {
    description: 'pm2 app name',
    string: true,
    default: 'selenium-federation',
  },
  'config': {
    description: 'configuration file',
    required: true,
    string: true,
    alias: 'c',
  }
}).strict().argv;


const bin = join(__dirname, 'selenium-federation');  // requirement of windows
const config = resolve(argv.config);  // requirement of pm2

spawn('pm2', ['start', '--name', argv.name, bin, '--', '-c', config], { detached: true });
